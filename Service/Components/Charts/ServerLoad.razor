@using Common.Managers;
@using Common.State.ServerStats;
@inject IState<ServerStatsState> _state
@inject IStatsManager _statManager

<RadzenChart>
    <RadzenLineSeries Smooth="false" Data="@_serverLoad" CategoryProperty="Time" Title="Server Load (ms)" LineType="LineType.Solid" ValueProperty="MS">
        <RadzenMarkers MarkerType="MarkerType.Square" />
        <RadzenLegend Visible="false" />
        <RadzenCategoryAxis Visible=false />
    </RadzenLineSeries>
</RadzenChart>

@code {
    IEnumerable<Load> _serverLoad = Enumerable.Empty<Load>();

    protected override void OnInitialized()
    {
        base.OnInitialized();

        _state.StateChanged += (_, _) =>
        {
            _serverLoad = _statManager.GetServerLoad();
            InvokeAsync(StateHasChanged);
        };

        _serverLoad = _statManager.GetServerLoad();
    }
}
